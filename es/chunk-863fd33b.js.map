{"version":3,"file":"chunk-863fd33b.js","sources":["../src/use/autoResize.js"],"sourcesContent":["import { useState, useCallback, useEffect, useRef } from 'react'\r\nimport { debounce, observerDomResize } from '../util/index'\r\n\r\nexport default function useAutoResize(afterAutoResizeMixinInit, onResize) {\r\n  const [state, setState] = useState({ width: 0, height: 0 })\r\n\r\n  const domRef = useRef(null)\r\n  const domObserverRef = useRef(null)\r\n  const debounceSetWHFunRef = useRef(null)\r\n  const onResizeRef = useRef(onResize)\r\n\r\n  onResizeRef.current = onResize\r\n\r\n  const setWH = useCallback((resize = true) => {\r\n    const { clientWidth, clientHeight } = domRef.current\r\n\r\n    setState({ width: clientWidth, height: clientHeight })\r\n\r\n    if (typeof onResizeRef.current === 'function' && resize) {\r\n      onResizeRef.current()\r\n    }\r\n  }, [])\r\n\r\n  const bindDomResizeCallback = useCallback(() => {\r\n    domObserverRef.current = observerDomResize(\r\n      domRef.current,\r\n      debounceSetWHFunRef.current\r\n    )\r\n\r\n    window.addEventListener('resize', debounceSetWHFunRef.current)\r\n  }, [])\r\n\r\n  const unbindDomResizeCallback = useCallback(() => {\r\n    const { current: domObserver } = domObserverRef\r\n\r\n    domObserver.disconnect()\r\n    domObserver.takeRecords()\r\n    domObserverRef.current = null\r\n\r\n    window.removeEventListener('resize', debounceSetWHFunRef.current)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    debounceSetWHFunRef.current = debounce(setWH, 100)\r\n\r\n    debounceSetWHFunRef.current(false)\r\n\r\n    bindDomResizeCallback()\r\n\r\n    typeof afterAutoResizeMixinInit === 'function' && afterAutoResizeMixinInit()\r\n\r\n    // 组件销毁时，清除事件\r\n    return unbindDomResizeCallback\r\n  }, [])\r\n\r\n  return { ...state, domRef }\r\n}\r\n"],"names":["useAutoResize","afterAutoResizeMixinInit","onResize","useState","width","height","state","setState","domRef","useRef","domObserverRef","debounceSetWHFunRef","onResizeRef","current","setWH","useCallback","resize","clientWidth","clientHeight","bindDomResizeCallback","observerDomResize","addEventListener","unbindDomResizeCallback","domObserver","disconnect","takeRecords","removeEventListener","debounce"],"mappings":";;;;AAGe,SAASA,aAAT,CAAuBC,wBAAvB,EAAiDC,QAAjD,EAA2D;kBAC9CC,SAAS,EAAEC,OAAO,CAAT,EAAYC,QAAQ,CAApB,EAAT,CAD8C;;MACjEC,KADiE;MAC1DC,QAD0D;;MAGlEC,SAASC,OAAO,IAAP,CAAf;MACMC,iBAAiBD,OAAO,IAAP,CAAvB;MACME,sBAAsBF,OAAO,IAAP,CAA5B;MACMG,cAAcH,OAAOP,QAAP,CAApB;;cAEYW,OAAZ,GAAsBX,QAAtB;;MAEMY,QAAQC,YAAY,YAAmB;QAAlBC,MAAkB,uEAAT,IAAS;0BACLR,OAAOK,OADF;QACnCI,WADmC,mBACnCA,WADmC;QACtBC,YADsB,mBACtBA,YADsB;;;aAGlC,EAAEd,OAAOa,WAAT,EAAsBZ,QAAQa,YAA9B,EAAT;;QAEI,OAAON,YAAYC,OAAnB,KAA+B,UAA/B,IAA6CG,MAAjD,EAAyD;kBAC3CH,OAAZ;;GANU,EAQX,EARW,CAAd;;MAUMM,wBAAwBJ,YAAY,YAAM;mBAC/BF,OAAf,GAAyBO,kBACvBZ,OAAOK,OADgB,EAEvBF,oBAAoBE,OAFG,CAAzB;;WAKOQ,gBAAP,CAAwB,QAAxB,EAAkCV,oBAAoBE,OAAtD;GAN4B,EAO3B,EAP2B,CAA9B;;MASMS,0BAA0BP,YAAY,YAAM;QAC/BQ,WAD+B,GACfb,cADe,CACxCG,OADwC;;;gBAGpCW,UAAZ;gBACYC,WAAZ;mBACeZ,OAAf,GAAyB,IAAzB;;WAEOa,mBAAP,CAA2B,QAA3B,EAAqCf,oBAAoBE,OAAzD;GAP8B,EAQ7B,EAR6B,CAAhC;;YAUU,YAAM;wBACMA,OAApB,GAA8Bc,SAASb,KAAT,EAAgB,GAAhB,CAA9B;;wBAEoBD,OAApB,CAA4B,KAA5B;;;;WAIOZ,wBAAP,KAAoC,UAApC,IAAkDA,0BAAlD;;;WAGOqB,uBAAP;GAVF,EAWG,EAXH;;sBAaYhB,KAAZ,IAAmBE,cAAnB;;;;;"}